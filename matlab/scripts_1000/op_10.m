function [Y,Xf,Af] = op_10(X,~,~)
%OP_10 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 17-Apr-2019 10:44:42.
% 
% [Y] = op_10(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 2xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [3.2387e-13;1.156e-14;-0.0017771];
x1_step1.gain = [2.18660485863677;2.70888921997539;8.21601210382903];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.1867462381241606906;1.9058963000521036424;0.069646903605289980921;-2.1394778637675129218;-1.8747025851484431236;3.9265924966519212269;-2.0493446623337310264;-8.2630855580412987393];
IW1_1 = [-0.13544711959324126638 -2.1089230795696205512 -1.5057892522566669324;-0.84023968292054429519 -0.011246214295987266851 1.8011894612895569256;1.3808414238784696426 0.1265323938052884678 0.44698935794875377381;-1.7058505981430791554 -0.47904581669639018093 -0.45963806156916248158;-4.8432562664030305299 2.9485026252738197883 0.22290882248532598031;1.870196370611808101 1.1901058992780080281 0.67985854925420530215;-0.34633654071303743294 1.3284143386661473318 1.46621171698252728;-4.3796254297947800893 -4.1966241384195708264 0.74886426100433156616];

% Layer 2
b2 = [1.9381578576446443218;-1.8901701966472923555;-0.93727756906027215322;0.23793444112436068494;-1.6908256833050290258;-0.22581032501021508496;-1.4051520734597007234;-1.8308006398865761533];
LW2_1 = [-0.57688709893503808956 0.19306176265630442535 -0.81300435009057536728 -0.56305909021023881067 0.46444826038529246626 0.21048093540823714642 -0.93484090477955184006 -0.81485975302354685113;-0.36143665636188837542 0.048321566454297838755 -1.3753203314304458527 1.5406585105247168066 1.2772490285776429975 -0.16584044036654424503 0.71961287732083112356 -3.3117318593337685684;0.33517934863394310829 -1.2130212447384705055 0.075195883494379764378 -0.49666668296961419271 -0.44456668257873438455 -0.19263518662200806997 -0.18359661217907732866 0.89290780181778461877;-0.39118704530887216109 -0.024107064066094262972 -0.27337147266193806416 0.26851696162493376985 4.550160724827470915 0.098649521634042808271 -0.4570843635115705017 -0.11570972810367562145;-0.45159571646347917984 -1.5399132935444190817 -0.009811819621671089009 1.4456681437632918907 -0.51510007522867529151 2.2063403537039869562 -0.59514691545799525141 -3.897860252371033507;0.18196721942228416546 -0.4683581138621536466 -0.39506690986748610461 0.7751593643327823191 -2.5195779222385721319 -0.26445283182234446961 -0.25047118329049405938 3.0495706700810147893;-0.18081035001977147081 -0.18978366041076677462 0.71263575618193941708 0.24659097328913559544 -0.44460627491365029007 0.33026229931567774312 0.0067673870934455209944 -0.87618025320083725571;-0.84868421069409127888 -0.49092450631865097721 -0.58902266653975143829 -0.62328155925079065103 0.7981953927486932221 0.091518123402217793627 0.61594941059610841538 0.78073341900603898669];

% Layer 3
b3 = [1.2039808420354094487;1.0614398130011641896;1.003675789342205249;-0.46033704157067500962;-0.6509265066184727333;-1.0468204934836442543;1.0148460742050255945;-2.0349864996751625412];
LW3_2 = [-1.6410864912734919319 0.57284994163964431113 0.46454453888566266118 -2.8740383706409597941 0.22252071991370162007 1.3308357130821255598 -0.52604125218724984148 -0.010274598901582486857;-0.50975562901493265411 -0.026785802679180830549 -0.38155736683638274975 0.81760337552026463026 1.3384254873775911499 0.5776245125813767034 -1.1247700211545406113 -0.12138070679177287436;-0.73190372748128573743 0.10859399184420318041 0.77362343901108576727 4.040435972521457586 2.6386163571831131591 -0.43664319027766312908 -0.46523339014610504139 -0.4635343509301332876;0.084120166815585345477 0.075750794452635092369 0.44576462638540542693 3.2843833477723016756 -1.2298840446288072936 -4.4688917183488374718 -0.18679242325456127394 -0.33071128808609834282;-0.5942931493429746137 0.91969792431267360922 0.45735495562223954513 0.30744628180781047311 1.8269096671920894703 -1.1967248412750943753 -0.59361562820417612674 -0.68501802747944373628;-1.2402110571640423409 -0.42054848472404299242 -0.44589412059587840709 0.42460801777564460835 -1.1436591398629796235 -0.27356518198321239099 0.64582981042168641217 0.0074131205573339190723;0.48730001008956269626 -4.7945306494537867081 0.38272390779243181669 1.3536210591560533523 -4.5580386707349287434 2.2842257999009403235 0.41436210011329416281 -0.8451506181188931377;-1.2183380004828281429 0.032641613546411957225 -0.12347479890031572147 -0.73838893256688786781 0.1942639842030432773 0.80982518636443190374 0.53147543009249087476 -0.3437233509304604695];

% Layer 4
b4 = [-1.9703727158499328986;-1.147070244848063636;0.84896448270470969977;-0.045900573347436988969;-0.27188265204089268057;0.82983964162291923294;0.78251811510140745209;1.3034458946784548417];
LW4_3 = [0.47659697823806285166 0.40691331745438807932 0.012972279222158588155 -1.7619323236966824009 0.26613497990520362801 0.88619759167571632297 -0.32974841212306393867 -0.31599804923732033313;1.5480260284279117045 -0.21510102816413817495 -1.0928371915357564248 0.369911178119952333 0.30836127209254354797 -0.42933304743221756272 0.94979173521102389088 -0.77782456709817437979;-0.21450307867956286412 0.86463498654147619149 -1.0965302637755387494 -1.1133610933504074492 -0.93644380108920566297 0.50311248832925115071 0.91748438486003325298 0.97239033948448683198;1.8444114925196550825 -0.19492991278365837116 -3.8580761705056665356 -3.3990658420066566237 -2.3495960503583415147 0.14932988551715978276 6.6261236377804282327 -0.069039249373355787709;-0.90062473879262150422 0.84600433962958265788 0.51115224839110617872 -0.48006389889171913188 0.61535072004918989208 0.61260989957343503498 1.2706228470792635399 -0.6573192957226279276;0.45991675351612526512 -1.0541016413451826939 1.6338286862370365871 0.098357547997928049255 -0.20597875284142894148 -1.0166584674541940814 -0.5421199474971237775 0.55287345739045523629;0.82764707098557488418 -0.0062543553495556817798 1.3759418043359774586 -2.2060894459855240335 -0.22286236488835661773 0.55717554139386027412 -1.6836028033178520591 1.3291004881822183759;1.8973420686751494291 -0.13428512895879737843 -3.2150410957804020917 -4.1174197149870730428 0.54542825100675684791 0.78108927879739942224 -4.8331241850719388609 -0.021511500617018685516];

% Layer 5
b5 = [-1.8587972288008807187;1.249453387973105567;0.56264732140299034135;-1.6291689361460912622;-0.21184993897480400293;0.40757912550524838524;-1.3487781983833488919;2.0949385142255692038];
LW5_4 = [0.62038449960845032383 -0.85168553778816868949 -0.23602840679726114215 0.61330813885444335209 -0.35791855361008151348 0.081677340014369728682 -0.89201032468394991781 0.79775522904553963777;-0.52831856579054603529 0.44281458553894653685 0.36141520566454049534 0.039736259566507468877 1.3092675925468295617 -0.53190524863330546079 0.034477277007972893796 -0.57142355092976138131;0.24798890697964812158 -0.49910393812573894401 -0.89753334232486947641 -2.6687191424860903233 -0.95306685052612194475 -0.2457412081271544424 -0.40130073522227521776 -3.0095938402008908241;1.2717341752292699031 -1.2546468266005084136 -1.8646103649368270805 -6.1358968832585141229 0.90481564279916970595 0.71546463546656269283 -2.4039280058395879891 -1.0412091184285363621;0.40238043746677909507 -1.0372502966398975399 1.4252400980319293033 -0.27428110689556445267 0.58265358212416296091 0.34344025114337262128 0.19298721964161827391 -0.62646377531585761833;0.62685740991464899974 -0.79633052943866844409 -1.2552247229121260563 -2.5538421546214031821 1.013384703194584624 0.37940599062511459749 0.75645514803340907495 0.33650848325490251289;-0.95934816294218372423 0.31923217913780399524 -0.63937174454188749895 -1.0691538599489889272 -1.5774609190495880728 -0.53396017544332974314 -2.1701010122490491661 -1.1460374915902749038;1.8691390920001784703 -1.0976761803538401807 0.78657933647768329966 -0.61856927986874776781 0.7578452133824782333 -0.68890110775167789914 0.81281947542421761899 -4.8423036399672536589];

% Layer 6
b6 = [-1.6311248987164272961;-0.96460539401927325454;-0.8788118595909127917;0.26341237004375922526;0.10113850367345487979;1.0605751564052869895;-1.0690360100656668418;-2.1902701280484753177];
LW6_5 = [0.73264165621739796297 0.33548975981781919975 -1.027415621854515182 0.45995057897304242323 0.50303366472310950819 -0.54177112498246260408 -0.49051155656082440215 -0.84263926957640578053;0.11780171648847961863 1.075604035095653721 -0.8153090195778277538 -2.2930123312423762449 0.15972789391054523223 -2.3282224874000054804 -0.7702583433046843453 3.7691199788306892771;1.131895436959360346 -0.66206204971356930056 0.38339612196869049532 0.93759302889579299034 0.43245204261409592172 0.11963259350751020982 -0.45026954629941212671 -0.64869037602341605986;-0.97234991037493712085 0.44178853542081680805 0.43847640070986898531 -0.35497903177530110153 -0.20354135129571485074 0.90318819415366657921 0.91210530136292256032 1.4367077946292370338;0.1655570666955161474 -0.079086885897054440275 -0.75394010835050784269 -0.95772886822799119244 -0.18534130891091879501 -0.97410197446055124537 -1.2718888258801481772 -0.93097587534559134159;0.61071051406744103485 -0.30648297228817245053 -0.12617930679524844151 0.64811488291159102815 -1.103312452399941801 0.56108891407481586988 1.4596638041128671137 -1.0626744046476064298;-0.55958481953698546718 -0.41630069388648455186 -1.1962678844179821525 0.87978060905789490231 0.83368926529982056994 1.2854730530759446161 -1.7571682901365124341 0.59106146052508978794;0.21922450751165514782 1.3530453559462087831 3.2382044504520903772 5.7008805225466669953 1.2183661760128539076 0.17039681628889707943 0.82862223811853397137 4.6493345210103287357];

% Layer 7
b7 = [1.046645882980975939;-0.50465785546898167535];
LW7_6 = [-0.13693553748471429254 -3.9839745851778207708 -0.59871632656800699568 1.608043163648706475 -1.7054902916582714845 2.3581464661680038297 0.89543833821148410834 7.8081007825315795756;-0.38329566231382133923 -0.16742481328457847756 -0.79107149979580193566 -1.5479208011163236858 -0.58752168251767877827 0.90512505946681842683 -2.3168509622286639349 0.019896738091784375857];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [8.03212851405623;6.68896321070234];
y1_step1.xoffset = [0.001;0.001];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = tansig_apply(repmat(b4,1,Q) + LW4_3*a3);
    
    % Layer 5
    a5 = tansig_apply(repmat(b5,1,Q) + LW5_4*a4);
    
    % Layer 6
    a6 = tansig_apply(repmat(b6,1,Q) + LW6_5*a5);
    
    % Layer 7
    a7 = repmat(b7,1,Q) + LW7_6*a6;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a7,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(7,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
